<Window x:Class="PicaPolloRey.POS.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Pica Pollo Rey - POS (Commit 1)"
        Height="650" Width="1050"
        WindowStartupLocation="CenterScreen">
    <Grid Margin="12">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2.1*"/>
            <ColumnDefinition Width="2.9*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.ColumnSpan="2" CornerRadius="10" Background="#FF1F2937" Padding="12" Margin="0,0,0,12">
            <DockPanel>
                <StackPanel>
                    <TextBlock Text="Pica Pollo Rey" Foreground="White" FontSize="22" FontWeight="Bold"/>
                    <TextBlock Text="POS - Commit 1 (Monolítico, Sin SQLite)" Foreground="#FFE5E7EB" FontSize="12"/>
                </StackPanel>
                <TextBlock DockPanel.Dock="Right"
                           Text="{Binding TodayText}"
                           Foreground="#FFE5E7EB"
                           FontSize="12"
                           VerticalAlignment="Center"/>
            </DockPanel>
        </Border>

        <!-- Left: Product List -->
        <GroupBox Grid.Row="1" Grid.Column="0" Header="Productos (Catálogo básico)" Margin="0,0,12,0">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <TextBlock Text="Buscar:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <TextBox Width="240" Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"/>
                    <TextBlock Text="   (filtra por nombre)" VerticalAlignment="Center" Foreground="Gray"/>
                </StackPanel>

                <DataGrid Grid.Row="1"
                          ItemsSource="{Binding FilteredProducts}"
                          SelectedItem="{Binding SelectedProduct}"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          CanUserAddRows="False"
                          SelectionMode="Single"
                          SelectionUnit="FullRow">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="60"/>
                        <DataGridTextColumn Header="Nombre" Binding="{Binding Name}" Width="*"/>
                        <DataGridTextColumn Header="Categoría" Binding="{Binding Category}" Width="140"/>
                        <DataGridTextColumn Header="Precio" Binding="{Binding Price, StringFormat=C}" Width="120"/>
                    </DataGrid.Columns>
                </DataGrid>

                <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                    <Button Content="Agregar al carrito"
                            Width="160" Height="34"
                            Click="BtnAddToCart_Click"/>
                </StackPanel>
            </Grid>
        </GroupBox>

        <!-- Right: Cart -->
        <GroupBox Grid.Row="1" Grid.Column="1" Header="Venta (Carrito)" >
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <DataGrid ItemsSource="{Binding Cart}"
                          SelectedItem="{Binding SelectedCartItem}"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          SelectionMode="Single"
                          SelectionUnit="FullRow"
                          IsReadOnly="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Producto" Binding="{Binding Product.Name}" IsReadOnly="True" Width="*"/>
                        <DataGridTextColumn Header="Precio" Binding="{Binding UnitPrice, StringFormat=C}" IsReadOnly="True" Width="120"/>
                        <DataGridTextColumn Header="Cant." Binding="{Binding Quantity}" Width="80"/>
                        <DataGridTextColumn Header="Total" Binding="{Binding LineTotal, StringFormat=C}" IsReadOnly="True" Width="120"/>
                    </DataGrid.Columns>
                </DataGrid>

                <Border Grid.Row="1" CornerRadius="10" BorderBrush="#FFE5E7EB" BorderThickness="1" Padding="12" Margin="0,10,0,0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="1.2*"/>
                            <ColumnDefinition Width="1.8*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Left: actions + payment -->
                        <StackPanel Grid.Column="0">
                            <TextBlock Text="Método de pago:" FontWeight="SemiBold" Margin="0,0,0,6"/>
                            <StackPanel Orientation="Horizontal">
                                <RadioButton Content="Efectivo" IsChecked="{Binding IsCash}" Margin="0,0,12,0"/>
                                <RadioButton Content="Tarjeta" IsChecked="{Binding IsCard}"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                                <Button Content="Quitar item" Width="110" Height="32" Margin="0,0,10,0"
                                        Click="BtnRemoveItem_Click"/>
                                <Button Content="Vaciar" Width="90" Height="32"
                                        Click="BtnClearCart_Click"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Right: totals + charge -->
                        <StackPanel Grid.Column="1" HorizontalAlignment="Right">
                            <TextBlock Text="{Binding SubtotalText}" FontSize="14" Margin="0,0,0,4"/>
                            <TextBlock Text="{Binding ItbisText}" FontSize="14" Margin="0,0,0,4"/>
                            <TextBlock Text="{Binding TotalText}" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>
                            <Button Content="COBRAR (Ticket)"
                                    Width="180" Height="40"
                                    Click="BtnCharge_Click"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </GroupBox>
    </Grid>
</Window>
